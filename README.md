# D_FAST_all

---

## Overview

D_FAST_all is a Python-based project designed to run on the PyCharm platform, implementing a feature extraction and similarity search algorithm for seismic signal detection. This project integrates the D_FAST algorithm and includes a dataset in the Releases directory under `PNWData1`. D_FAST is a waveform-based detection method inspired by Philips' audio fingerprinting algorithm, offering improved detection speed and reduced memory usage compared to the original FAST algorithm. D_FAST maintains strong noise resilience and performs well even under low signal-to-noise ratios (SNR).

---

## Table of Contents
- [Getting Started](#getting-started)
- [Prerequisites](#prerequisites)
- [Installation Steps](#installation-steps)
- [File Directory Explanation](#file-directory-explanation)
- [Functionality Overview](#functionality-overview)
- [License](#license)
- [Acknowledgements](#acknowledgements)

---

## Getting Started

To get started with D_FAST_all, replace all instances of `your_github_name/D_FAST_all` with `your_github_name/your_repository` in the links for proper linking.

### Prerequisites
- Python 3.x
- PyCharm IDE
- NumPy
- Pandas
- Matplotlib
- ObsPy

If you want to run your own seismic waveform data using the code we provided, follow these steps:

1. **Preprocess the waveform**: Use `process_signal_waveforms.py` in the `preprocess` folder to filter the waveform and extract it based on the P-wave arrival time, saving it in `.npy` format.
   - Refer to the waveform data in our provided data folder `earthquake\B023\P_waveform`.

2. **Feature Extraction**: Use `LEDS.py` in the `LEDS` folder to extract features and generate binary fingerprints in `.txt` format.
   - Create a new folder for saving waveform fingerprints (refer to the fingerprint data in our provided data folder `earthquake\B023\fp`).

3. **Generate Fingerprint Database**: Use `fp_database.py` in the `WMPLSH` folder to generate the fingerprint database in `.pkl` format.

4. **Generate Hash Index Table**: Run `index_table.py` to create the hash index table.

5. **Run Detection**: Run `wmplsh.py` to print the detection results and generate the precision-recall curve.

---

## File Directory Explanation

```
D_FAST_all
├── LEDS/
│   ├── LEDS.py
│   ├── pair_sim_calculate.py
│   └── result_plot.py
├── WMPLSH/
│   ├── index_table.py
│   ├── wmplsh.py
│   └── Roc_plot.py
├── FAST/
│   ├── Fingerprint_Extraction.py
│   ├── LSH.py
│   └── evalution.py
├── preprocess/
├── Releases/
│   └── PNWData1/
├── README.md
└── LICENSE.txt
```

### Data Structure in PNWData1
The `PNWData1` folder in `Releases` contains the primary dataset, including raw seismic data and preprocessed data from the PNW dataset:
- **catalag/**: Contains directories for earthquake and noise event types.
- **earthquake/** and **explosion/**: Store waveform data from various stations.
  - **original/**: Holds raw waveform data in `.pkl` format.
  - **P_waveform/**: Contains preprocessed waveforms in `.npy` format (filtered and extracted based on P-wave arrival).
  - **fp/** and **fp_fast/**: Store binary fingerprints generated by D_FAST and FAST algorithms.
  - **waveform_plot/** and **spectrogram_plot/**: Store original waveform and spectrogram plots.
  - **noise/**: Contains noise waveform data and associated fingerprints.

To download the dataset, visit [PNW-ML](https://github.com/niyiyu/PNW-ML). Use the preprocessing scripts in `preprocess/` to filter and prepare the raw waveform data for analysis.

---

## Functionality Overview

### LEDS Folder
- **LEDS.py**: Extracts features to generate binary fingerprints. Takes waveform data in `.npy` format from the input folder and stores the resulting fingerprints in the output folder.
- **pair_sim_calculate.py**: Calculates pairwise similarity of fingerprints.
- **result_plot.py**: Visualizes similarity distribution of fingerprints to validate the fingerprint extraction effectiveness.

### WMPLSH Folder
- **index_table.py**: Generates a hash index table for use in similarity searches.
- **wmplsh.py**: Executes similarity searches and summarizes detection statistics.
- **Roc_plot.py**: Plots detection results using ROC curves.

### FAST Folder
- **Fingerprint_Extraction.py**: Implements the original FAST algorithm for generating sparse binary fingerprints.
- **LSH.py**: Conducts similarity searches using the FAST algorithm.
- **evalution.py**: Compares the performance of D_FAST against FAST and visualizes results.

---

## License
This project is licensed under the MIT License. See `LICENSE.txt` for details.
